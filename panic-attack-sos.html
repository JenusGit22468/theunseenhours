<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panic Attack SOS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 9999;
            padding: 20px;
            text-align: center;
        }

        .home-button {
            position: absolute;
            top: 30px;
            left: 30px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .home-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .emergency-header {
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 700;
            color: #ff4757;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 71, 87, 0.3);
            animation: urgentPulse 2s ease-in-out infinite;
        }

        @keyframes urgentPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .step-container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
        }

        .step {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-number {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 700;
            color: #ff4757;
            margin-bottom: 15px;
        }

        .step-title {
            font-size: clamp(1.8rem, 5vw, 3rem);
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.2;
        }

        .step-content {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            line-height: 1.6;
            margin-bottom: 40px;
            color: rgba(255, 255, 255, 0.9);
        }

        .breathing-guide {
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            font-weight: 500;
            color: #5dade2;
            margin: 30px 0;
            animation: breatheText 4s ease-in-out infinite;
        }

        @keyframes breatheText {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .action-button {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.3);
            margin: 20px 10px;
        }

        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 71, 87, 0.4);
        }

        .secondary-button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 10px;
            backdrop-filter: blur(10px);
        }

        .secondary-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .progress-bar {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .progress-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: #ff4757;
            transform: scale(1.2);
            box-shadow: 0 0 15px rgba(255, 71, 87, 0.5);
        }

        .emergency-contacts {
            background: rgba(255, 71, 87, 0.1);
            border: 2px solid rgba(255, 71, 87, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
        }

        .contact-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: clamp(1rem, 2.5vw, 1.2rem);
        }

        .contact-item:last-child {
            border-bottom: none;
        }

        .contact-number {
            color: #5dade2;
            font-weight: 600;
            text-decoration: none;
        }

        .contact-number:hover {
            text-decoration: underline;
        }

        .affirmation {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            max-width: 600px;
            padding: 0 20px;
            animation: fadeInOut 8s ease-in-out infinite;
        }

        .disclaimer {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            color: rgba(255, 255, 255, 0.5);
            text-align: center;
            max-width: 90%;
            padding: 0 20px;
            line-height: 1.3;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 8px;
            font-style: italic;
        }

        @keyframes fadeInOut {
            0%, 20%, 80%, 100% { opacity: 0.7; }
            40%, 60% { opacity: 1; }
        }

        .calm-visual {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(93, 173, 226, 0.3) 0%, rgba(93, 173, 226, 0.1) 70%, transparent 100%);
            animation: calmPulse 4s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes calmPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.3; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.6; }
        }

        /* MOBILE-ONLY FIXES - Desktop unchanged */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                height: 100vh;
                height: 100dvh; /* Use dynamic viewport height */
            }
            
            .emergency-header {
                margin-bottom: 10px;
            }
            
            .step-number {
                margin-bottom: 8px;
            }
            
            .step-title {
                margin-bottom: 12px;
            }
            
            .step-content {
                margin-bottom: 20px;
                max-height: 40vh;
                overflow-y: auto;
            }
            
            .breathing-guide {
                margin: 15px 0;
            }
            
            .action-button {
                padding: 15px 30px;
                margin: 10px 5px;
            }
            
            .secondary-button {
                padding: 12px 25px;
                margin: 10px 5px;
            }
            
            .emergency-contacts {
                padding: 15px;
                margin: 15px 0;
                max-height: 35vh;
                overflow-y: auto;
            }
            
            .contact-item {
                flex-direction: column;
                gap: 5px;
                text-align: center;
                padding: 10px 0;
            }
            
            .progress-bar {
                top: 60px;
            }
            
            .affirmation {
                bottom: 70px;
                max-width: 95%;
                padding: 0 10px;
                font-size: 0.85rem;
            }
            
            .disclaimer {
                bottom: 5px;
                max-width: 95%;
                padding: 0 10px;
                padding-top: 5px;
                line-height: 1.2;
                font-size: 0.7rem;
            }
            
            .home-button {
                top: 15px;
                left: 15px;
                padding: 8px 15px;
                font-size: 12px;
            }
        }

        /* Extra small phones */
        @media (max-width: 480px) and (max-height: 700px) {
            .step-content {
                max-height: 30vh;
                font-size: 1rem;
                line-height: 1.4;
                margin-bottom: 15px;
            }
            
            .emergency-contacts {
                max-height: 30vh;
                padding: 12px;
                margin: 10px 0;
            }
            
            .breathing-guide {
                margin: 10px 0;
            }
            
            .progress-bar {
                top: 50px;
            }
            
            .affirmation {
                bottom: 50px;
                font-size: 0.75rem;
            }
            
            .disclaimer {
                font-size: 0.6rem;
                bottom: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>

        <!-- Home Button -->
        <button class="home-button" onclick="goHome()">← Home</button>
        <div class="step active" id="step1">
            <div class="emergency-header">🚨 PANIC ATTACK SOS</div>
            <div class="step-number">STEP 1</div>
            <div class="step-title">You're Having a Panic Attack</div>
            <div class="step-content">
                This is scary, but you are SAFE.<br>
                This feeling is temporary and WILL pass.<br>
                You've survived every panic attack before this one.
            </div>
            <button class="action-button" onclick="nextStep()">I Understand → Continue</button>
        </div>

        <!-- Step 2: Grounding -->
        <div class="step" id="step2">
            <div class="step-number">STEP 2</div>
            <div class="step-title">Ground Yourself NOW</div>
            <div class="step-content">
                Look around and name out loud:<br><br>
                <strong>5 things you can SEE</strong><br>
                <strong>4 things you can TOUCH</strong><br>
                <strong>3 things you can HEAR</strong><br>
                <strong>2 things you can SMELL</strong><br>
                <strong>1 thing you can TASTE</strong>
            </div>
            <button class="action-button" onclick="nextStep()">I Did This → Continue</button>
            <button class="secondary-button" onclick="openGroundingTool()">Open Grounding Tool</button>
        </div>

        <!-- Step 3: Breathing -->
        <div class="step" id="step3">
            <div class="step-number">STEP 3</div>
            <div class="step-title">Focus on Your Breathing</div>
            <div class="breathing-guide" id="breathingGuide">Breathe in for 4...</div>
            <div class="step-content">
                Follow the guide above.<br>
                Put one hand on your chest, one on your belly.<br>
                Make sure your belly hand moves more than your chest hand.
            </div>
            <button class="action-button" onclick="nextStep()">I'm Breathing Better → Continue</button>
            <button class="secondary-button" onclick="openBreathingTool()">Open Breathing Tool</button>
        </div>

        <!-- Step 4: Reassurance -->
        <div class="step" id="step4">
            <div class="step-number">STEP 4</div>
            <div class="step-title">Remind Yourself</div>
            <div class="step-content">
                Say out loud or in your head:<br><br>
                <strong>"This is just anxiety. I am not in danger."</strong><br>
                <strong>"This feeling will pass in a few minutes."</strong><br>
                <strong>"I am stronger than this panic."</strong><br>
                <strong>"I have survived this before."</strong>
            </div>
            <button class="action-button" onclick="nextStep()">I Told Myself This → Continue</button>
        </div>

        <!-- Step 5: Get Help if Needed -->
        <div class="step" id="step5">
            <div class="step-number">STEP 5</div>
            <div class="step-title">You're Doing Great</div>
            <div class="step-content">
                If you're still feeling intense panic, it's okay to reach out for help.
                <div class="emergency-contacts">
                    <div class="contact-item">
                        <span>Crisis Text Line</span>
                        <a href="sms:741741" class="contact-number">Text HOME to 741741</a>
                    </div>
                    <div class="contact-item">
                        <span>National Suicide Prevention Lifeline</span>
                        <a href="tel:988" class="contact-number">Call 988</a>
                    </div>
                    <div class="contact-item">
                        <span>Emergency Services</span>
                        <a href="tel:911" class="contact-number">Call 911</a>
                    </div>
                </div>
            </div>
            <button class="action-button" onclick="nextStep()">I'm Feeling Better → Continue</button>
        </div>

        <!-- Step 6: Recovery -->
        <div class="step" id="step6">
            <div class="step-number">RECOVERY</div>
            <div class="step-title">You Did It! 🌟</div>
            <div class="step-content">
                You just survived another panic attack.<br>
                That took courage and strength.<br><br>
                Take a moment to be proud of yourself.<br>
                Consider what triggered this so you can prepare next time.
            </div>
            <button class="action-button" onclick="restartSOS()">🔄 Restart SOS</button>
            <button class="secondary-button" onclick="goHome()">🏠 Explore More Tools</button>
        </div>

        <!-- Rotating Affirmations -->
        <div class="affirmation" id="affirmation">You are safe. This feeling will pass.</div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            This tool is for support only. If you are in immediate danger or having thoughts of self-harm, please contact emergency services (911) or a crisis hotline immediately.
        </div>
    </div>

    <!-- Calm Visual Background -->
    <div class="calm-visual"></div>

    <script>
        let currentStep = 1;
        let breathingInterval;
        const totalSteps = 6;

        const affirmations = [
            "You are safe. This feeling will pass.",
            "You are stronger than your anxiety.",
            "You have survived every panic attack before this.",
            "This is temporary. You will get through this.",
            "You are not in danger. This is just your body's alarm system.",
            "Breathe. Ground yourself. You've got this.",
            "Your feelings are valid, but this panic is not permanent.",
            "You are brave for facing this moment."
        ];

        function nextStep() {
            if (currentStep < totalSteps) {
                // Hide current step
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                // Update progress
                document.querySelectorAll('.progress-dot')[currentStep - 1].classList.remove('active');
                
                currentStep++;
                
                // Show next step
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.querySelectorAll('.progress-dot')[currentStep - 1].classList.add('active');
                
                // Start breathing guide if on step 3
                if (currentStep === 3) {
                    startBreathingGuide();
                } else {
                    stopBreathingGuide();
                }
            }
        }

        function startBreathingGuide() {
            const breathingGuide = document.getElementById('breathingGuide');
            let phase = 0; // 0: inhale, 1: hold, 2: exhale, 3: hold
            let count = 4;
            
            const phases = [
                { text: "Breathe in for", color: "#5dade2" },
                { text: "Hold for", color: "#f39c12" },
                { text: "Breathe out for", color: "#e74c3c" },
                { text: "Hold for", color: "#9b59b6" }
            ];

            breathingInterval = setInterval(() => {
                breathingGuide.textContent = `${phases[phase].text} ${count}...`;
                breathingGuide.style.color = phases[phase].color;
                
                count--;
                
                if (count < 0) {
                    phase = (phase + 1) % 4;
                    count = 4;
                }
            }, 1000);
        }

        function stopBreathingGuide() {
            if (breathingInterval) {
                clearInterval(breathingInterval);
            }
        }

        function restartSOS() {
            // Reset to step 1
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.querySelectorAll('.progress-dot').forEach(dot => dot.classList.remove('active'));
            
            currentStep = 1;
            document.getElementById('step1').classList.add('active');
            document.querySelectorAll('.progress-dot')[0].classList.add('active');
            
            stopBreathingGuide();
        }

        function goHome() {
            if (confirm("Are you feeling better? This will take you back to explore other tools.")) {
                // In a real website, this would navigate to your home page
                window.history.back();
            }
        }

        function openGroundingTool() {
            window.open('https://www.theunseenhours.org/54321-sensory-grounding', '_blank');
        }

        function openBreathingTool() {
            window.open('https://www.theunseenhours.org/breathe', '_blank');
        }

        // Rotate affirmations
        let affirmationIndex = 0;
        setInterval(() => {
            affirmationIndex = (affirmationIndex + 1) % affirmations.length;
            document.getElementById('affirmation').textContent = affirmations[affirmationIndex];
        }, 8000);

        // Prevent page refresh/back during panic attack
        window.addEventListener('beforeunload', function(e) {
            if (currentStep > 1 && currentStep < 6) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>
